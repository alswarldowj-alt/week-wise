
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=0">
    <title>WeekWise - 移动端周数专家</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
    
    <!-- 库引用 -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        :root {
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background-color: #000000;
            color: #ffffff;
            margin: 0;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            overflow: hidden; /* 保持 iPhone App 感，防止滚动条闪烁 */
        }
        .ios-glass {
            background: rgba(28, 28, 30, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 0.5px solid rgba(255, 255, 255, 0.1);
        }
        .gradient-text {
            background: linear-gradient(135deg, #3b82f6 0%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            /* 解决斜体裁剪问题的关键：增加内边距 */
            padding-right: 0.15em; 
            margin-right: -0.15em;
        }
        .big-number {
            font-size: 7rem; /* 从 8rem 下调至 7rem 确保适配 */
            line-height: 1;
            font-weight: 900;
            letter-spacing: -0.05em;
            display: inline-block;
        }
        input[type="date"] {
            appearance: none;
            -webkit-appearance: none;
            color: #ffffff;
            background: transparent;
            border: none;
            font-size: 1.25rem;
            width: 100%;
            outline: none;
            font-family: inherit;
        }
        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
            scale: 1.3;
        }
        .safe-pb {
            padding-bottom: calc(var(--safe-bottom) + 1.5rem);
        }
        .safe-pt {
            padding-top: calc(var(--safe-top) + 1rem);
        }
        /* 针对不同屏幕高度的微调 */
        @media (max-height: 700px) {
            .big-number { font-size: 6rem; }
            .main-content { margin-top: -1rem; }
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // ISO-8601 周数算法
        const getISOWeek = (date) => {
            const d = new Date(date.valueOf());
            const day = (date.getDay() + 6) % 7;
            d.setDate(d.getDate() - day + 3);
            const firstThursday = d.valueOf();
            d.setMonth(0, 1);
            if (d.getDay() !== 4) d.setMonth(0, 1 + ((4 - d.getDay() + 7) % 7));
            return 1 + Math.ceil((firstThursday - d.valueOf()) / 604800000);
        };

        const App = () => {
            const [now, setNow] = useState(new Date());
            const [target, setTarget] = useState(new Date().toISOString().split('T')[0]);

            useEffect(() => {
                const timer = setInterval(() => setNow(new Date()), 60000);
                return () => clearInterval(timer);
            }, []);

            const currentWeek = useMemo(() => getISOWeek(now), [now]);
            const targetWeek = useMemo(() => {
                const d = new Date(target);
                return isNaN(d.getTime()) ? null : getISOWeek(d);
            }, [target]);

            return (
                <div className="h-screen w-full flex flex-col px-6 safe-pt safe-pb overflow-hidden">
                    {/* 灵动岛风格标题栏 */}
                    <header className="flex justify-center shrink-0 mb-6">
                        <div className="bg-[#1c1c1e] px-5 py-2 rounded-full border border-white/5 flex items-center space-x-2 shadow-lg">
                            <div className="w-1.5 h-1.5 bg-blue-500 rounded-full animate-pulse"></div>
                            <span className="text-[9px] font-black uppercase tracking-[0.2em] text-blue-400">WeekWise Live</span>
                        </div>
                    </header>

                    {/* 主显示区域：聚焦当前周数 */}
                    <main className="flex-1 flex flex-col items-center justify-center text-center main-content">
                        <p className="text-slate-500 font-bold uppercase tracking-[0.25em] text-[10px] mb-2">CURRENT WEEK</p>
                        <div className="relative inline-block">
                            <h2 className="big-number gradient-text italic">
                                {String(currentWeek).padStart(2, '0')}
                            </h2>
                            <div className="absolute -bottom-2 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-blue-500/40 to-transparent blur-sm"></div>
                        </div>
                        <p className="mt-8 text-lg font-semibold text-white/80 tracking-tight">
                            {new Intl.DateTimeFormat('zh-CN', { month: 'long', day: 'numeric', weekday: 'short' }).format(now)}
                        </p>
                    </main>

                    {/* 交互控制区域 */}
                    <section className="shrink-0 space-y-4">
                        {/* 磨砂玻璃输入卡片 */}
                        <div className="ios-glass rounded-[2.5rem] p-7 shadow-2xl">
                            <div className="flex justify-between items-center mb-4">
                                <label className="text-[10px] font-black text-slate-500 uppercase tracking-widest">日期查询</label>
                                <span className="text-[9px] bg-white/5 px-2 py-0.5 rounded-md text-slate-400">ISO-8601</span>
                            </div>
                            
                            <div className="flex items-center justify-between border-b border-white/5 pb-3 mb-6">
                                <input 
                                    type="date" 
                                    value={target}
                                    onChange={(e) => setTarget(e.target.value)}
                                />
                            </div>
                            
                            <div className="flex items-end justify-between">
                                <div>
                                    <p className="text-slate-400 text-xs font-medium">目标周数结果</p>
                                    <p className="text-4xl font-black text-white mt-1">
                                        W{String(targetWeek || 0).padStart(2, '0')}
                                    </p>
                                </div>
                                <div className="text-right pb-1">
                                    <div className="flex space-x-1 justify-end">
                                        {[...Array(7)].map((_, i) => (
                                            <div key={i} className={`w-0.5 h-4 rounded-full ${i < 5 ? 'bg-blue-500' : 'bg-white/10'}`}></div>
                                        ))}
                                    </div>
                                    <p className="text-slate-600 text-[8px] font-bold uppercase mt-2 tracking-tighter">Week Progress</p>
                                </div>
                            </div>
                        </div>

                        {/* 数据概览小卡片 */}
                        <div className="flex gap-3">
                            <div className="flex-1 ios-glass rounded-3xl p-5 flex flex-col justify-between h-24">
                                <p className="text-[9px] font-black text-slate-500 uppercase">年度进度</p>
                                <div className="flex items-baseline space-x-1">
                                    <span className="text-2xl font-bold text-white">{Math.round((currentWeek / 52) * 100)}</span>
                                    <span className="text-xs text-slate-500 font-bold">%</span>
                                </div>
                                <div className="w-full h-1 bg-white/5 rounded-full overflow-hidden">
                                    <div className="h-full bg-blue-500" style={{width: `${(currentWeek/52)*100}%`}}></div>
                                </div>
                            </div>
                            <div className="flex-1 ios-glass rounded-3xl p-5 flex flex-col justify-between h-24">
                                <p className="text-[9px] font-black text-slate-500 uppercase">剩余周数</p>
                                <p className="text-2xl font-bold text-purple-400">
                                    {52 - currentWeek}
                                </p>
                                <p className="text-[8px] text-slate-600 font-bold uppercase">WEEKS REMAINING</p>
                            </div>
                        </div>
                    </section>

                    {/* 底部版权信息 */}
                    <footer className="shrink-0 mt-8 mb-4 text-center">
                        <p className="text-slate-800 text-[8px] font-black uppercase tracking-[0.4em]">WeekWise Precision Utility</p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>
